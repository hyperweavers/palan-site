import{d as De}from"./chunk-CTBTKHLJ.js";import{a as x}from"./chunk-KRUSALRW.js";import{Ca as we,D as ue,E as Z,Ea as ve,F as Q,H as de,J as fe,Ma as Ee,Q as X,R as pe,X as me,Y as H,_ as N,a as ce,ba as ge,cc as Ne,e as Y,ea as D,h as q,ha as k,ic as Re,ka as w,l as le,la as v,oa as ye,q as he,qa as Te,r as P,ra as be,sc as Pe,v as b}from"./chunk-ZG3MT3EK.js";var S=function(n){return n[n.OPEN=0]="OPEN",n[n.CLOSED=1]="CLOSED",n}(S||{}),L=function(n){return n[n.UP=1]="UP",n[n.DOWN=-1]="DOWN",n}(L||{});var U=class{static epochToUtcTimestamp(r){return r&&r>0?Math.trunc(r/1e3):-1}static getTimestampSince(r,e){if(r&&r instanceof Date&&!isNaN(r.getTime())){let t=new Date(r);return t.setDate(t.getDate()-Math.abs(e)),t.getTime()}else return-1}};var B=class{},J=class{},R=class n{headers;normalizedNames=new Map;lazyInit;lazyUpdate=null;constructor(r){r?typeof r=="string"?this.lazyInit=()=>{this.headers=new Map,r.split(`
`).forEach(e=>{let t=e.indexOf(":");if(t>0){let s=e.slice(0,t),i=e.slice(t+1).trim();this.addHeaderEntry(s,i)}})}:typeof Headers<"u"&&r instanceof Headers?(this.headers=new Map,r.forEach((e,t)=>{this.addHeaderEntry(t,e)})):this.lazyInit=()=>{this.headers=new Map,Object.entries(r).forEach(([e,t])=>{this.setHeaderEntries(e,t)})}:this.headers=new Map}has(r){return this.init(),this.headers.has(r.toLowerCase())}get(r){this.init();let e=this.headers.get(r.toLowerCase());return e&&e.length>0?e[0]:null}keys(){return this.init(),Array.from(this.normalizedNames.values())}getAll(r){return this.init(),this.headers.get(r.toLowerCase())||null}append(r,e){return this.clone({name:r,value:e,op:"a"})}set(r,e){return this.clone({name:r,value:e,op:"s"})}delete(r,e){return this.clone({name:r,value:e,op:"d"})}maybeSetNormalizedName(r,e){this.normalizedNames.has(e)||this.normalizedNames.set(e,r)}init(){this.lazyInit&&(this.lazyInit instanceof n?this.copyFrom(this.lazyInit):this.lazyInit(),this.lazyInit=null,this.lazyUpdate&&(this.lazyUpdate.forEach(r=>this.applyUpdate(r)),this.lazyUpdate=null))}copyFrom(r){r.init(),Array.from(r.headers.keys()).forEach(e=>{this.headers.set(e,r.headers.get(e)),this.normalizedNames.set(e,r.normalizedNames.get(e))})}clone(r){let e=new n;return e.lazyInit=this.lazyInit&&this.lazyInit instanceof n?this.lazyInit:this,e.lazyUpdate=(this.lazyUpdate||[]).concat([r]),e}applyUpdate(r){let e=r.name.toLowerCase();switch(r.op){case"a":case"s":let t=r.value;if(typeof t=="string"&&(t=[t]),t.length===0)return;this.maybeSetNormalizedName(r.name,e);let s=(r.op==="a"?this.headers.get(e):void 0)||[];s.push(...t),this.headers.set(e,s);break;case"d":let i=r.value;if(!i)this.headers.delete(e),this.normalizedNames.delete(e);else{let o=this.headers.get(e);if(!o)return;o=o.filter(d=>i.indexOf(d)===-1),o.length===0?(this.headers.delete(e),this.normalizedNames.delete(e)):this.headers.set(e,o)}break}}addHeaderEntry(r,e){let t=r.toLowerCase();this.maybeSetNormalizedName(r,t),this.headers.has(t)?this.headers.get(t).push(e):this.headers.set(t,[e])}setHeaderEntries(r,e){let t=(Array.isArray(e)?e:[e]).map(i=>i.toString()),s=r.toLowerCase();this.headers.set(s,t),this.maybeSetNormalizedName(r,s)}forEach(r){this.init(),Array.from(this.normalizedNames.keys()).forEach(e=>r(this.normalizedNames.get(e),this.headers.get(e)))}};var re=class{encodeKey(r){return Oe(r)}encodeValue(r){return Oe(r)}decodeKey(r){return decodeURIComponent(r)}decodeValue(r){return decodeURIComponent(r)}};function Se(n,r){let e=new Map;return n.length>0&&n.replace(/^\?/,"").split("&").forEach(s=>{let i=s.indexOf("="),[o,d]=i==-1?[r.decodeKey(s),""]:[r.decodeKey(s.slice(0,i)),r.decodeValue(s.slice(i+1))],c=e.get(o)||[];c.push(d),e.set(o,c)}),e}var Ce=/%(\d[a-f0-9])/gi,Be={40:"@","3A":":",24:"$","2C":",","3B":";","3D":"=","3F":"?","2F":"/"};function Oe(n){return encodeURIComponent(n).replace(Ce,(r,e)=>Be[e]??r)}function V(n){return`${n}`}var A=class n{map;encoder;updates=null;cloneFrom=null;constructor(r={}){if(this.encoder=r.encoder||new re,r.fromString){if(r.fromObject)throw new Error("Cannot specify both fromString and fromObject.");this.map=Se(r.fromString,this.encoder)}else r.fromObject?(this.map=new Map,Object.keys(r.fromObject).forEach(e=>{let t=r.fromObject[e],s=Array.isArray(t)?t.map(V):[V(t)];this.map.set(e,s)})):this.map=null}has(r){return this.init(),this.map.has(r)}get(r){this.init();let e=this.map.get(r);return e?e[0]:null}getAll(r){return this.init(),this.map.get(r)||null}keys(){return this.init(),Array.from(this.map.keys())}append(r,e){return this.clone({param:r,value:e,op:"a"})}appendAll(r){let e=[];return Object.keys(r).forEach(t=>{let s=r[t];Array.isArray(s)?s.forEach(i=>{e.push({param:t,value:i,op:"a"})}):e.push({param:t,value:s,op:"a"})}),this.clone(e)}set(r,e){return this.clone({param:r,value:e,op:"s"})}delete(r,e){return this.clone({param:r,value:e,op:"d"})}toString(){return this.init(),this.keys().map(r=>{let e=this.encoder.encodeKey(r);return this.map.get(r).map(t=>e+"="+this.encoder.encodeValue(t)).join("&")}).filter(r=>r!=="").join("&")}clone(r){let e=new n({encoder:this.encoder});return e.cloneFrom=this.cloneFrom||this,e.updates=(this.updates||[]).concat(r),e}init(){this.map===null&&(this.map=new Map),this.cloneFrom!==null&&(this.cloneFrom.init(),this.cloneFrom.keys().forEach(r=>this.map.set(r,this.cloneFrom.map.get(r))),this.updates.forEach(r=>{switch(r.op){case"a":case"s":let e=(r.op==="a"?this.map.get(r.param):void 0)||[];e.push(V(r.value)),this.map.set(r.param,e);break;case"d":if(r.value!==void 0){let t=this.map.get(r.param)||[],s=t.indexOf(V(r.value));s!==-1&&t.splice(s,1),t.length>0?this.map.set(r.param,t):this.map.delete(r.param)}else{this.map.delete(r.param);break}}}),this.cloneFrom=this.updates=null)}};var te=class{map=new Map;set(r,e){return this.map.set(r,e),this}get(r){return this.map.has(r)||this.map.set(r,r.defaultValue()),this.map.get(r)}delete(r){return this.map.delete(r),this}has(r){return this.map.has(r)}keys(){return this.map.keys()}};function $e(n){switch(n){case"DELETE":case"GET":case"HEAD":case"OPTIONS":case"JSONP":return!1;default:return!0}}function Ae(n){return typeof ArrayBuffer<"u"&&n instanceof ArrayBuffer}function _e(n){return typeof Blob<"u"&&n instanceof Blob}function Ie(n){return typeof FormData<"u"&&n instanceof FormData}function ze(n){return typeof URLSearchParams<"u"&&n instanceof URLSearchParams}var C=class n{url;body=null;headers;context;reportProgress=!1;withCredentials=!1;responseType="json";method;params;urlWithParams;transferCache;constructor(r,e,t,s){this.url=e,this.method=r.toUpperCase();let i;if($e(this.method)||s?(this.body=t!==void 0?t:null,i=s):i=t,i&&(this.reportProgress=!!i.reportProgress,this.withCredentials=!!i.withCredentials,i.responseType&&(this.responseType=i.responseType),i.headers&&(this.headers=i.headers),i.context&&(this.context=i.context),i.params&&(this.params=i.params),this.transferCache=i.transferCache),this.headers??=new R,this.context??=new te,!this.params)this.params=new A,this.urlWithParams=e;else{let o=this.params.toString();if(o.length===0)this.urlWithParams=e;else{let d=e.indexOf("?"),c=d===-1?"?":d<e.length-1?"&":"";this.urlWithParams=e+c+o}}}serializeBody(){return this.body===null?null:typeof this.body=="string"||Ae(this.body)||_e(this.body)||Ie(this.body)||ze(this.body)?this.body:this.body instanceof A?this.body.toString():typeof this.body=="object"||typeof this.body=="boolean"||Array.isArray(this.body)?JSON.stringify(this.body):this.body.toString()}detectContentTypeHeader(){return this.body===null||Ie(this.body)?null:_e(this.body)?this.body.type||null:Ae(this.body)?null:typeof this.body=="string"?"text/plain":this.body instanceof A?"application/x-www-form-urlencoded;charset=UTF-8":typeof this.body=="object"||typeof this.body=="number"||typeof this.body=="boolean"?"application/json":null}clone(r={}){let e=r.method||this.method,t=r.url||this.url,s=r.responseType||this.responseType,i=r.transferCache??this.transferCache,o=r.body!==void 0?r.body:this.body,d=r.withCredentials??this.withCredentials,c=r.reportProgress??this.reportProgress,f=r.headers||this.headers,g=r.params||this.params,p=r.context??this.context;return r.setHeaders!==void 0&&(f=Object.keys(r.setHeaders).reduce((E,h)=>E.set(h,r.setHeaders[h]),f)),r.setParams&&(g=Object.keys(r.setParams).reduce((E,h)=>E.set(h,r.setParams[h]),g)),new n(e,t,o,{params:g,headers:f,context:p,reportProgress:c,responseType:s,withCredentials:d,transferCache:i})}},_=function(n){return n[n.Sent=0]="Sent",n[n.UploadProgress=1]="UploadProgress",n[n.ResponseHeader=2]="ResponseHeader",n[n.DownloadProgress=3]="DownloadProgress",n[n.Response=4]="Response",n[n.User=5]="User",n}(_||{}),$=class{headers;status;statusText;url;ok;type;constructor(r,e=200,t="OK"){this.headers=r.headers||new R,this.status=r.status!==void 0?r.status:e,this.statusText=r.statusText||t,this.url=r.url||null,this.ok=this.status>=200&&this.status<300}},G=class n extends ${constructor(r={}){super(r)}type=_.ResponseHeader;clone(r={}){return new n({headers:r.headers||this.headers,status:r.status!==void 0?r.status:this.status,statusText:r.statusText||this.statusText,url:r.url||this.url||void 0})}},z=class n extends ${body;constructor(r={}){super(r),this.body=r.body!==void 0?r.body:null}type=_.Response;clone(r={}){return new n({body:r.body!==void 0?r.body:this.body,headers:r.headers||this.headers,status:r.status!==void 0?r.status:this.status,statusText:r.statusText||this.statusText,url:r.url||this.url||void 0})}},O=class extends ${name="HttpErrorResponse";message;error;ok=!1;constructor(r){super(r,0,"Unknown Error"),this.status>=200&&this.status<300?this.message=`Http failure during parsing for ${r.url||"(unknown url)"}`:this.message=`Http failure response for ${r.url||"(unknown url)"}: ${r.status} ${r.statusText}`,this.error=r.error||null}},Le=200,Xe=204;function ee(n,r){return{body:r,headers:n.headers,context:n.context,observe:n.observe,params:n.params,reportProgress:n.reportProgress,responseType:n.responseType,withCredentials:n.withCredentials,transferCache:n.transferCache}}var oe=(()=>{class n{handler;constructor(e){this.handler=e}request(e,t,s={}){let i;if(e instanceof C)i=e;else{let c;s.headers instanceof R?c=s.headers:c=new R(s.headers);let f;s.params&&(s.params instanceof A?f=s.params:f=new A({fromObject:s.params})),i=new C(e,t,s.body!==void 0?s.body:null,{headers:c,context:s.context,params:f,reportProgress:s.reportProgress,responseType:s.responseType||"json",withCredentials:s.withCredentials,transferCache:s.transferCache})}let o=P(i).pipe(fe(c=>this.handler.handle(c)));if(e instanceof C||s.observe==="events")return o;let d=o.pipe(de(c=>c instanceof z));switch(s.observe||"body"){case"body":switch(i.responseType){case"arraybuffer":return d.pipe(b(c=>{if(c.body!==null&&!(c.body instanceof ArrayBuffer))throw new Error("Response is not an ArrayBuffer.");return c.body}));case"blob":return d.pipe(b(c=>{if(c.body!==null&&!(c.body instanceof Blob))throw new Error("Response is not a Blob.");return c.body}));case"text":return d.pipe(b(c=>{if(c.body!==null&&typeof c.body!="string")throw new Error("Response is not a string.");return c.body}));case"json":default:return d.pipe(b(c=>c.body))}case"response":return d;default:throw new Error(`Unreachable: unhandled observe type ${s.observe}}`)}}delete(e,t={}){return this.request("DELETE",e,t)}get(e,t={}){return this.request("GET",e,t)}head(e,t={}){return this.request("HEAD",e,t)}jsonp(e,t){return this.request("JSONP",e,{params:new A().append(t,"JSONP_CALLBACK"),observe:"body",responseType:"json"})}options(e,t={}){return this.request("OPTIONS",e,t)}patch(e,t,s={}){return this.request("PATCH",e,ee(s,t))}post(e,t,s={}){return this.request("POST",e,ee(s,t))}put(e,t,s={}){return this.request("PUT",e,ee(s,t))}static \u0275fac=function(t){return new(t||n)(w(B))};static \u0275prov=D({token:n,factory:n.\u0275fac})}return n})(),Ve=/^\)\]\}',?\n/,Je="X-Request-URL";function Me(n){if(n.url)return n.url;let r=Je.toLocaleLowerCase();return n.headers.get(r)}var Ge=(()=>{class n{fetchImpl=v(ne,{optional:!0})?.fetch??((...e)=>globalThis.fetch(...e));ngZone=v(ve);handle(e){return new q(t=>{let s=new AbortController;return this.doRequest(e,s.signal,t).then(se,i=>t.error(new O({error:i}))),()=>s.abort()})}doRequest(e,t,s){return Y(this,null,function*(){let i=this.createRequestInit(e),o;try{let h=this.ngZone.runOutsideAngular(()=>this.fetchImpl(e.urlWithParams,ce({signal:t},i)));We(h),s.next({type:_.Sent}),o=yield h}catch(h){s.error(new O({error:h,status:h.status??0,statusText:h.statusText,url:e.urlWithParams,headers:h.headers}));return}let d=new R(o.headers),c=o.statusText,f=Me(o)??e.urlWithParams,g=o.status,p=null;if(e.reportProgress&&s.next(new G({headers:d,status:g,statusText:c,url:f})),o.body){let h=o.headers.get("content-length"),I=[],l=o.body.getReader(),u=0,y,T,m=typeof Zone<"u"&&Zone.current;yield this.ngZone.runOutsideAngular(()=>Y(this,null,function*(){for(;;){let{done:M,value:j}=yield l.read();if(M)break;if(I.push(j),u+=j.length,e.reportProgress){T=e.responseType==="text"?(T??"")+(y??=new TextDecoder).decode(j,{stream:!0}):void 0;let ae=()=>s.next({type:_.DownloadProgress,total:h?+h:void 0,loaded:u,partialText:T});m?m.run(ae):ae()}}}));let F=this.concatChunks(I,u);try{let M=o.headers.get("Content-Type")??"";p=this.parseBody(e,F,M)}catch(M){s.error(new O({error:M,headers:new R(o.headers),status:o.status,statusText:o.statusText,url:Me(o)??e.urlWithParams}));return}}g===0&&(g=p?Le:0),g>=200&&g<300?(s.next(new z({body:p,headers:d,status:g,statusText:c,url:f})),s.complete()):s.error(new O({error:p,headers:d,status:g,statusText:c,url:f}))})}parseBody(e,t,s){switch(e.responseType){case"json":let i=new TextDecoder().decode(t).replace(Ve,"");return i===""?null:JSON.parse(i);case"text":return new TextDecoder().decode(t);case"blob":return new Blob([t],{type:s});case"arraybuffer":return t.buffer}}createRequestInit(e){let t={},s=e.withCredentials?"include":void 0;if(e.headers.forEach((i,o)=>t[i]=o.join(",")),e.headers.has("Accept")||(t.Accept="application/json, text/plain, */*"),!e.headers.has("Content-Type")){let i=e.detectContentTypeHeader();i!==null&&(t["Content-Type"]=i)}return{body:e.serializeBody(),method:e.method,headers:t,credentials:s}}concatChunks(e,t){let s=new Uint8Array(t),i=0;for(let o of e)s.set(o,i),i+=o.length;return s}static \u0275fac=function(t){return new(t||n)};static \u0275prov=D({token:n,factory:n.\u0275fac})}return n})(),ne=class{};function se(){}function We(n){n.then(se,se)}function Ke(n,r){return r(n)}function Ye(n,r,e){return(t,s)=>be(e,()=>r(t,i=>n(i,s)))}var Ue=new k(""),qe=new k(""),Ze=new k("",{providedIn:"root",factory:()=>!0});var ke=(()=>{class n extends B{backend;injector;chain=null;pendingTasks=v(we);contributeToStability=v(Ze);constructor(e,t){super(),this.backend=e,this.injector=t}handle(e){if(this.chain===null){let t=Array.from(new Set([...this.injector.get(Ue),...this.injector.get(qe,[])]));this.chain=t.reduceRight((s,i)=>Ye(s,i,this.injector),Ke)}if(this.contributeToStability){let t=this.pendingTasks.add();return this.chain(e,s=>this.backend.handle(s)).pipe(pe(()=>this.pendingTasks.remove(t)))}else return this.chain(e,t=>this.backend.handle(t))}static \u0275fac=function(t){return new(t||n)(w(J),w(Te))};static \u0275prov=D({token:n,factory:n.\u0275fac})}return n})();var Qe=/^\)\]\}',?\n/;function He(n){return"responseURL"in n&&n.responseURL?n.responseURL:/^X-Request-URL:/m.test(n.getAllResponseHeaders())?n.getResponseHeader("X-Request-URL"):null}var xe=(()=>{class n{xhrFactory;constructor(e){this.xhrFactory=e}handle(e){if(e.method==="JSONP")throw new ge(-2800,!1);let t=this.xhrFactory;return(t.\u0275loadImpl?he(t.\u0275loadImpl()):P(null)).pipe(N(()=>new q(i=>{let o=t.build();if(o.open(e.method,e.urlWithParams),e.withCredentials&&(o.withCredentials=!0),e.headers.forEach((l,u)=>o.setRequestHeader(l,u.join(","))),e.headers.has("Accept")||o.setRequestHeader("Accept","application/json, text/plain, */*"),!e.headers.has("Content-Type")){let l=e.detectContentTypeHeader();l!==null&&o.setRequestHeader("Content-Type",l)}if(e.responseType){let l=e.responseType.toLowerCase();o.responseType=l!=="json"?l:"text"}let d=e.serializeBody(),c=null,f=()=>{if(c!==null)return c;let l=o.statusText||"OK",u=new R(o.getAllResponseHeaders()),y=He(o)||e.url;return c=new G({headers:u,status:o.status,statusText:l,url:y}),c},g=()=>{let{headers:l,status:u,statusText:y,url:T}=f(),m=null;u!==Xe&&(m=typeof o.response>"u"?o.responseText:o.response),u===0&&(u=m?Le:0);let F=u>=200&&u<300;if(e.responseType==="json"&&typeof m=="string"){let M=m;m=m.replace(Qe,"");try{m=m!==""?JSON.parse(m):null}catch(j){m=M,F&&(F=!1,m={error:j,text:m})}}F?(i.next(new z({body:m,headers:l,status:u,statusText:y,url:T||void 0})),i.complete()):i.error(new O({error:m,headers:l,status:u,statusText:y,url:T||void 0}))},p=l=>{let{url:u}=f(),y=new O({error:l,status:o.status||0,statusText:o.statusText||"Unknown Error",url:u||void 0});i.error(y)},E=!1,h=l=>{E||(i.next(f()),E=!0);let u={type:_.DownloadProgress,loaded:l.loaded};l.lengthComputable&&(u.total=l.total),e.responseType==="text"&&o.responseText&&(u.partialText=o.responseText),i.next(u)},I=l=>{let u={type:_.UploadProgress,loaded:l.loaded};l.lengthComputable&&(u.total=l.total),i.next(u)};return o.addEventListener("load",g),o.addEventListener("error",p),o.addEventListener("timeout",p),o.addEventListener("abort",p),e.reportProgress&&(o.addEventListener("progress",h),d!==null&&o.upload&&o.upload.addEventListener("progress",I)),o.send(d),i.next({type:_.Sent}),()=>{o.removeEventListener("error",p),o.removeEventListener("abort",p),o.removeEventListener("load",g),o.removeEventListener("timeout",p),e.reportProgress&&(o.removeEventListener("progress",h),d!==null&&o.upload&&o.upload.removeEventListener("progress",I)),o.readyState!==o.DONE&&o.abort()}})))}static \u0275fac=function(t){return new(t||n)(w(Pe))};static \u0275prov=D({token:n,factory:n.\u0275fac})}return n})(),Fe=new k(""),er="XSRF-TOKEN",rr=new k("",{providedIn:"root",factory:()=>er}),tr="X-XSRF-TOKEN",nr=new k("",{providedIn:"root",factory:()=>tr}),W=class{},sr=(()=>{class n{doc;platform;cookieName;lastCookieString="";lastToken=null;parseCount=0;constructor(e,t,s){this.doc=e,this.platform=t,this.cookieName=s}getToken(){if(this.platform==="server")return null;let e=this.doc.cookie||"";return e!==this.lastCookieString&&(this.parseCount++,this.lastToken=Re(e,this.cookieName),this.lastCookieString=e),this.lastToken}static \u0275fac=function(t){return new(t||n)(w(Ne),w(Ee),w(rr))};static \u0275prov=D({token:n,factory:n.\u0275fac})}return n})();function or(n,r){let e=n.url.toLowerCase();if(!v(Fe)||n.method==="GET"||n.method==="HEAD"||e.startsWith("http://")||e.startsWith("https://"))return r(n);let t=v(W).getToken(),s=v(nr);return t!=null&&!n.headers.has(s)&&(n=n.clone({headers:n.headers.set(s,t)})),r(n)}function Ir(...n){let r=[oe,xe,ke,{provide:B,useExisting:ke},{provide:J,useFactory:()=>v(Ge,{optional:!0})??v(xe)},{provide:Ue,useValue:or,multi:!0},{provide:Fe,useValue:!0},{provide:W,useClass:sr}];for(let e of n)r.push(...e.\u0275providers);return ye(r)}var ie=function(n){return n.LIVE="OPEN",n.CLOSE="CLOSED",n}(ie||{}),K=function(n){return n.OK="ok",n.NO_DATA="no_data",n.ERROR="error",n}(K||{});var kr={Rupee:"INR",USD:"USD",EUR:"EUR",GBP:"GBP",CAD:"CAD","AUS Dollar":"AUD",Yen:"JPY","Singapore Dollar":"SGD","Taiwan Dollar":"TWD",Renimbi:"CNY"};var a=class n{static GLOBAL_SYMBOL_REGEXP=new RegExp(/^\w+:\w+$/);static getDirection(r){return r>=0?L.UP:L.DOWN}static stringToNumber(r){return Number(r.replace(/,/g,""))}static dateStringToEpoch(r){return new Date(r).getTime()}static getBusinessDays(r,e){let t=new Date(r),s=new Date(e),i=0;for(;t<=s;){let o=t.getDay();o!==0&&o!==6&&i++,t.setDate(t.getDate()+1)}return i}static isBusinessDay(r){let e=r.getDay();return!(e==0||e==6)}static getLastBusinessDay(r){for(;!n.isBusinessDay(r);)r.setDate(r.getDate()-1);return r}static extractScripCodesFromMcSearchResult(r){let e="";try{e=new DOMParser().parseFromString(r,"text/html").querySelector("span")?.textContent||""}catch(t){console.error(`An error occurred while trying to parse MC search result "${r}": ${t}`)}if(e){let t=e.split(","),i=n.GLOBAL_SYMBOL_REGEXP.test(t[1].trim())?t[1].trim().split(":"):["",""];return{isin:t[0].trim(),ticker:i[0]||"",country:i[1]||""}}else return null}};var Jr=(()=>{class n{http;settingsService;marketStatus$;MAX_CHART_HISTORY_IN_DAYS=5*365;poll$;refresh$=new le(null);constructor(e,t){this.http=e,this.settingsService=t,this.marketStatus$=this.settingsService.settings$.pipe(X("refreshInterval"),N(({refreshInterval:s})=>Q(Z(0,s),this.refresh$.pipe(H(1))))).pipe(N(()=>this.http.get(x.api.MARKET_STATUS+"CAT:US").pipe(b(({data:s})=>({lastUpdated:s.lastupd_epoch,status:s.market_state===ie.LIVE?S.OPEN:S.CLOSED}))))).pipe(me(1)),this.poll$=this.marketStatus$.pipe(X("status"),N(({status:s})=>ue(()=>s===S.OPEN,this.settingsService.settings$.pipe(X("refreshInterval"),N(({refreshInterval:i})=>Q(Z(0,i),this.refresh$.pipe(H(1))))),this.refresh$)))}refresh(){this.refresh$.next(null)}search(e){return e?this.http.get(x.api.STOCK_SEARCH+encodeURIComponent(e)).pipe(b(t=>t.map(s=>({name:s.stock_name,scripCode:a.extractScripCodesFromMcSearchResult(s.pdt_dis_nm)??{},vendorCode:{mc:{primary:s.sc_id}}})))):P([])}getStock(e){return this.poll$.pipe(N(()=>this.http.get(x.api.STOCK_QUOTE+e).pipe(b(({data:t})=>({name:t.name,scripCode:{ticker:t.ticker||void 0,country:t.symbol.split(":")[1]||void 0},vendorCode:{mc:{primary:t.symbol}},details:{sector:t.sector},quote:{lastUpdated:t.lastupd_epoch,price:a.stringToNumber(t.current_price),change:{direction:a.getDirection(a.stringToNumber(t.percent_change)),percentage:a.stringToNumber(t.percent_change),value:a.stringToNumber(t.net_change)},open:a.stringToNumber(t.open),close:a.stringToNumber(t.prev_close),low:a.stringToNumber(t.low),high:a.stringToNumber(t.high),fiftyTwoWeekLow:a.stringToNumber(t["52wkLow"]),fiftyTwoWeekHigh:a.stringToNumber(t["52wkHigh"])},metrics:{marketCap:a.stringToNumber(t.market_cap_billion),dividendYield:a.stringToNumber(t.dy)},performance:{yearToDate:{direction:a.getDirection(a.stringToNumber(t.ytd_per_change)),percentage:a.stringToNumber(t.ytd_per_change),value:a.stringToNumber(t.ytd_change)},weekly:{direction:a.getDirection(a.stringToNumber(t.weekly_per_change)),percentage:a.stringToNumber(t.weekly_per_change),value:a.stringToNumber(t.weekly_change)},monthly:{direction:a.getDirection(a.stringToNumber(t.monthly_per_change)),percentage:a.stringToNumber(t.monthly_per_change),value:a.stringToNumber(t.monthly_change)},quarterly:{direction:a.getDirection(a.stringToNumber(t["3months_per_change"])),percentage:a.stringToNumber(t["3months_per_change"]),value:a.stringToNumber(t["3months_change"])},halfYearly:{direction:a.getDirection(a.stringToNumber(t["6months_per_change"])),percentage:a.stringToNumber(t["6months_per_change"]),value:a.stringToNumber(t["6months_change"])},yearly:{one:{direction:a.getDirection(a.stringToNumber(t.yearly_per_change)),percentage:a.stringToNumber(t.yearly_per_change),value:a.stringToNumber(t.yearly_change)},two:{direction:a.getDirection(a.stringToNumber(t["2years_per_change"])),percentage:a.stringToNumber(t["2years_per_change"]),value:a.stringToNumber(t["2years_change"])},three:{direction:a.getDirection(a.stringToNumber(t["3years_per_change"])),percentage:a.stringToNumber(t["3years_per_change"]),value:a.stringToNumber(t["3years_change"])},five:{direction:a.getDirection(a.stringToNumber(t["5years_per_change"])),percentage:a.stringToNumber(t["5years_per_change"]),value:a.stringToNumber(t["5years_change"])}}}})))))}getHistoricalChart(e){if(e){let t=U.getTimestampSince(new Date,this.MAX_CHART_HISTORY_IN_DAYS),s=Date.now(),i=`symbol=${encodeURIComponent(e)}&from=${U.epochToUtcTimestamp(t)}&to=${U.epochToUtcTimestamp(s)}&countback=${a.getBusinessDays(t,s)}`;return t>0?this.http.get(x.api.STOCK_HISTORIC_CHART+i).pipe(b(({s:o,o:d,c,h:f,l:g,t:p})=>o===K.OK&&p&&p.length>0?[...new Set(p)].map((E,h)=>{let I=new Date(E).toLocaleDateString("en-CA",{timeZone:"Asia/Kolkata"}),l=h>0?c[h-1]:void 0,u=c[h],y,T;return l&&(y=u-l,T=y/l*100),{time:I,open:d[h],close:c[h],high:f[h],low:g[h],value:c[h],previousDayClose:l,change:y!==void 0&&T!==void 0?{direction:a.getDirection(T),percentage:T,value:y}:void 0,lineColor:T&&a.getDirection(T)===L.UP?"#22c55e":"#ef4444"}}):[])):P([])}else return console.error(`Invalid symbol: ${e}`),P([])}getIntraDayChart(e){return e?this.poll$.pipe(N(()=>this.http.get(x.api.STOCK_INTRA_DAY_CHART+encodeURIComponent(e)).pipe(b(({s:t,data:s})=>t===K.OK&&s&&s.length>0?s:[])))):(console.error(`Invalid symbol: ${e}`),P([]))}static \u0275fac=function(t){return new(t||n)(w(oe),w(De))};static \u0275prov=D({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();export{oe as a,Ir as b,S as c,L as d,kr as e,U as f,Jr as g};
